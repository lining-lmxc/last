{% extends "base.html" %}

{% block content %}
<div class="spread-container">
    <div class="page-header">
        <h1>{{ spread_data.title }}</h1>
        <p class="period">{{ spread_data.period }}</p>
        <p class="data-source">数据来源：{{ spread_data.data_source }}</p>
    </div>

    <!-- 将朝代茶叶传播路径部分移动到这里 -->
    <div class="dynasty-tea-routes">
        <h1 class="section-title">历代茶叶传播路径</h1>
        
        <div class="dynasty-selector">
            <button class="dynasty-btn active" data-dynasty="tang">唐</button>
            <button class="dynasty-btn" data-dynasty="song">宋</button>
            <button class="dynasty-btn" data-dynasty="yuan">元</button>
            <button class="dynasty-btn" data-dynasty="ming">明</button>
            <button class="dynasty-btn" data-dynasty="qing">清</button>
        </div>
        
        <div class="map-container">
            <div id="tea-route-map" style="width: 100%; height: 500px;"></div>
        </div>
        
        <div class="route-info-panel">
            <div class="dynasty-info tang-info active">
                <h3>唐代茶叶传播 (618-907)</h3>
                <p>主要路线：陆上丝绸之路、茶马古道雏形、海上航线</p>
                <p>关键事件：日本僧人最澄、空海携茶籽归国，茶文化传入日本；文成公主入藏带去茶叶与茶具</p>
                <p>特点：茶叶作为商品与丝绸并重，唐代煎茶法及茶具传入阿拉伯地区，茶饮成为贵族风尚</p>
            </div>
            <div class="dynasty-info song-info">
                <h3>宋代茶叶传播 (960-1279)</h3>
                <p>主要路线：海上丝绸之路兴盛、茶马古道制度化、北方草原茶路</p>
                <p>关键事件：荣西禅师携茶种归日本，著《吃茶养生记》；设"茶马司"，以茶易马强化边疆经济纽带</p>
                <p>特点：泉州港繁荣，茶叶经海路传播至东南亚、印度洋、东非；茶叶通过回纥商人传入草原游牧民族</p>
            </div>
            <div class="dynasty-info yuan-info">
                <h3>元代茶叶传播 (1271-1368)</h3>
                <p>主要路线：草原茶路扩展、海上贸易延续、宗教传播</p>
                <p>关键事件：蒙古帝国打通欧亚陆路，泉州港成为"东方第一大港"</p>
                <p>特点：砖茶成为游牧民族生活必需品；茶叶随蒙古军队西征传入中亚，与佛教仪轨结合</p>
            </div>
            <div class="dynasty-info ming-info">
                <h3>明代茶叶传播 (1368-1644)</h3>
                <p>主要路线：郑和下西洋与海上茶路、万里茶道形成、欧洲殖民航线</p>
                <p>关键事件：黑茶、青砖茶通过驼队运往俄罗斯；葡萄牙(1557年澳门)、荷兰(1610年)开始从福建/广东运茶至欧洲</p>
                <p>特点：茶叶成为郑和下西洋的外交礼品；广州、泉州、宁波成为茶叶集散地；茶叶在欧洲成为奢侈品</p>
            </div>
            <div class="dynasty-info qing-info">
                <h3>清代茶叶传播 (1644-1911)</h3>
                <p>主要路线：万里茶道鼎盛、海上全球化、殖民种植扩散</p>
                <p>关键事件：英国东印度公司窃取茶种(1834年)，印度阿萨姆红茶取代中国垄断；1784年"中国皇后号"从广州直航纽约</p>
                <p>特点：中国对俄茶叶出口占贸易总额80%以上；武夷红茶风靡英国；茶种传播至印度、锡兰和俄罗斯</p>
            </div>
        </div>
    </div>


    

    <div class="tea-ware-evolution">
        <h2>茶具演变历程</h2>
        <div class="evolution-container">
            <div class="era-section">
                <div class="era-title">唐代茶具</div>
                <div class="tea-ware-item">
                    <div class="ware-name">鎏金银茶碾</div>
                    <div class="ware-detail">
                        <p>法门寺地宫出土，用于碾碎茶饼</p>
                        <div class="historical-source">《茶经·四之器》："碾以橘木为之，次以梨、桑、桐、柘为之。"</div>
                    </div>
                </div>
                <div class="tea-ware-item">
                    <div class="ware-name">鎏金银茶罗</div>
                    <div class="ware-detail">
                        <p>用于筛分茶末，确保茶粉细腻</p>
                        <div class="historical-source">《茶经·四之器》："罗末，以合盖贮之，以则置合中。"</div>
                    </div>
                </div>
            </div>

            <div class="era-section">
                <div class="era-title">宋代茶具</div>
                <div class="tea-ware-item">
                    <div class="ware-name">建窑兔毫盏</div>
                    <div class="ware-detail">
                        <p>黑釉茶盏，适合点茶斗茶</p>
                        <div class="historical-source">《大观茶论》："盏色贵青黑，玉毫条达者为上。"</div>
                    </div>
                </div>
                <div class="tea-ware-item">
                    <div class="ware-name">茶筅</div>
                    <div class="ware-detail">
                        <p>竹制，用于击拂茶汤</p>
                        <div class="historical-source">《茶录》："茶筅以筋竹老者为之，身欲厚重，筅欲疏劲。"</div>
                    </div>
                </div>
            </div>

            <div class="era-section">
                <div class="era-title">明代茶具</div>
                <div class="tea-ware-item">
                    <div class="ware-name">紫砂壶</div>
                    <div class="ware-detail">
                        <p>宜兴紫砂，适合泡散茶</p>
                        <div class="historical-source">《阳羡茗壶系》："壶经久用，涤拭日加，自发黯然之光，入手可鉴。"</div>
                    </div>
                </div>
                <div class="tea-ware-item">
                    <div class="ware-name">青花盖碗</div>
                    <div class="ware-detail">
                        <p>景德镇瓷器，泡茶品饮</p>
                        <div class="historical-source">《陶说》："景德镇窑，宋景德年间烧造，土白壤而埴，质薄腻，色滋润。"</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 添加文献查询面板 -->
        <div class="literature-panel">
            <h3>古籍文献查询</h3>
            <div class="search-box">
                <input type="text" id="literature-search" placeholder="输入关键词搜索文献...">
                <button id="search-btn">搜索</button>
            </div>
            <div class="literature-list">
                <div class="literature-item" data-keywords="茶经 陆羽 唐代">
                    <div class="literature-title">《茶经》</div>
                    <div class="literature-info">
                        <p>作者：陆羽</p>
                        <p>年代：唐代</p>
                        <p>主要内容：系统论述茶叶生产、加工、饮用等</p>
                    </div>
                    <div class="literature-quote">
                        <p>"茶之为饮，发乎神农氏，闻于鲁周公。"</p>
                    </div>
                </div>
                <div class="literature-item" data-keywords="大观茶论 宋徽宗 宋代">
                    <div class="literature-title">《大观茶论》</div>
                    <div class="literature-info">
                        <p>作者：宋徽宗</p>
                        <p>年代：宋代</p>
                        <p>主要内容：论述宋代点茶技艺</p>
                    </div>
                    <div class="literature-quote">
                        <p>"茶之为物，擅瓯闽之秀气，钟山川之灵禀。"</p>
                    </div>
                </div>
                <div class="literature-item" data-keywords="茶录 蔡襄 宋代">
                    <div class="literature-title">《茶录》</div>
                    <div class="literature-info">
                        <p>作者：蔡襄</p>
                        <p>年代：宋代</p>
                        <p>主要内容：记录宋代茶事</p>
                    </div>
                    <div class="literature-quote">
                        <p>"茶色贵白，而饼茶多以珍膏油其面，故有青黄紫黑之异。"</p>
                    </div>
                </div>
                <div class="literature-item" data-keywords="阳羡茗壶系 周高起 明代">
                    <div class="literature-title">《阳羡茗壶系》</div>
                    <div class="literature-info">
                        <p>作者：周高起</p>
                        <p>年代：明代</p>
                        <p>主要内容：论述紫砂壶制作</p>
                    </div>
                    <div class="literature-quote">
                        <p>"壶经久用，涤拭日加，自发黯然之光，入手可鉴。"</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="tea-horse-trade">
        <h2>茶马互市与民族交往</h2>
        <div class="trade-container">
            <div class="trade-map">
                <div class="trade-route">
                    <div class="route-title">茶马古道</div>
                    <div class="route-path">
                        <div class="node" data-info="茶叶产地，贸易起点">云南</div>
                        <div class="arrow">→</div>
                        <div class="node" data-info="重要中转站，民族聚居地">大理</div>
                        <div class="arrow">→</div>
                        <div class="node" data-info="藏族聚居区，马匹产地">西藏</div>
                        <div class="arrow">→</div>
                        <div class="node" data-info="贸易终点，连接中亚">青海</div>
                    </div>
                </div>
            </div>

            <div class="trade-history">
                <div class="history-item">
                    <div class="era">唐代</div>
                    <div class="content">
                        <p>设立茶马司，开始官方茶马贸易</p>
                        <div class="source">《新唐书·食货志》："贞元中，吐蕃请茶，诏许之。"</div>
                    </div>
                </div>
                <div class="history-item">
                    <div class="era">宋代</div>
                    <div class="content">
                        <p>茶马互市制度完善，设立榷场</p>
                        <div class="source">《宋史·食货志》："凡茶之利，官得其七，商得其三。"</div>
                    </div>
                </div>
                <div class="history-item">
                    <div class="era">明代</div>
                    <div class="content">
                        <p>茶马贸易达到鼎盛，形成固定路线</p>
                        <div class="source">《明史·食货志》："茶马之政，所以驭番夷，制边陲。"</div>
                    </div>
                </div>
            </div>

            <div class="cultural-exchange">
                <h3>文化交流</h3>
                <div class="exchange-items">
                    <div class="exchange-item">
                        <div class="title">茶马古道</div>
                        <div class="description">
                            <p>连接汉藏文化的重要通道</p>
                            <p>促进民族融合与文化交流</p>
                        </div>
                    </div>
                    <div class="exchange-item">
                        <div class="title">贸易往来</div>
                        <div class="description">
                            <p>茶叶换取马匹，互通有无</p>
                            <p>形成稳定的经济联系</p>
                        </div>
                    </div>
                    <div class="exchange-item">
                        <div class="title">文化融合</div>
                        <div class="description">
                            <p>茶文化传播到少数民族地区</p>
                            <p>形成独特的饮茶习俗</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.spread-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    background: linear-gradient(135deg, #f9f7f0 0%, #e8e6d9 100%);
}

.page-header {
    text-align: center;
    margin-bottom: 40px;
}

.page-header h1 {
    color: #8B4513;
    font-family: 'Calligraphy';
    font-size: 32px;
    margin-bottom: 10px;
}

.period {
    color: #666;
    font-size: 18px;
}

.historical-context {
    background: white;
    padding: 30px;
    border-radius: 10px;
    margin-bottom: 40px;
    box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
}

.timeline-container {
    background: white;
    padding: 30px;
    border-radius: 10px;
    margin-bottom: 30px;
    box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
}

.timeline {
    position: relative;
    padding: 20px 0;
}

.timeline-item {
    display: flex;
    margin-bottom: 30px;
    position: relative;
}

.timeline-icon {
    width: 60px;
    height: 60px;
    background: linear-gradient(45deg, #8B4513, #D2B48C);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Calligraphy';
    font-size: 24px;
    margin-right: 20px;
    flex-shrink: 0;
}

.timeline-content {
    background: #f9f7f0;
    padding: 20px;
    border-radius: 8px;
    flex-grow: 1;
    border: 1px solid #D2B48C;
}

.timeline-content h3 {
    color: #8B4513;
    font-family: 'Calligraphy';
    margin-bottom: 10px;
}

.timeline-content p {
    color: #666;
    margin-bottom: 10px;
}

.historical-detail {
    background: rgba(139, 69, 19, 0.05);
    padding: 10px;
    border-radius: 4px;
    border-left: 3px solid #8B4513;
    margin-top: 10px;
}

.historical-detail p {
    color: #8B4513;
    font-style: italic;
    margin: 0;
}

.price-history {
    background: white;
    padding: 30px;
    border-radius: 10px;
    margin-bottom: 30px;
    box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
}

.price-chart {
    display: flex;
    justify-content: space-between;
    gap: 20px;
}

.price-item {
    flex: 1;
    background: #f9f7f0;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #D2B48C;
}

.era {
    color: #8B4513;
    font-family: 'Calligraphy';
    font-size: 24px;
    text-align: center;
    margin-bottom: 15px;
}

.price-info {
    color: #666;
    margin-bottom: 15px;
}

.source {
    color: #8B4513;
    font-size: 14px;
    text-align: right;
    font-style: italic;
}

.route-map {
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
    margin-bottom: 40px;
}

.route-container {
    display: flex;
    flex-direction: column;
    gap: 30px;
}

.route-item {
    padding: 20px;
    border-radius: 8px;
}

.route-item h3 {
    color: #8B4513;
    font-family: 'Calligraphy';
    margin-bottom: 20px;
    text-align: center;
}

.route-path {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    position: relative;
}

.node {
    background: #f9f7f0;
    padding: 10px 20px;
    border-radius: 20px;
    border: 2px solid #D2B48C;
    color: #8B4513;
    font-weight: bold;
    min-width: 80px;
    text-align: center;
    position: relative;
    cursor: pointer;
}

.arrow {
    color: #8B4513;
    font-size: 20px;
    font-weight: bold;
}

.route-item.land {
    background: linear-gradient(135deg, #f9f7f0 0%, #e8e6d9 100%);
    border: 2px solid #D2B48C;
}

.route-item.sea {
    background: linear-gradient(135deg, #e8e6d9 0%, #f9f7f0 100%);
    border: 2px solid #8B4513;
}

.route-item.east {
    background: linear-gradient(135deg, #f9f7f0 0%, #e8e6d9 100%);
    border: 2px solid #A0522D;
}

.node::after {
    content: attr(data-info);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    padding: 10px;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid #D2B48C;
    border-radius: 8px;
    color: #8B4513;
    font-size: 14px;
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.3s;
    z-index: 100;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.node:hover::after {
    opacity: 1;
}

.route-path::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    transition: background 0.3s;
}

.route-path:hover::before {
    background: rgba(255, 255, 255, 0.2);
}

.tea-ware-evolution {
    background: white;
    padding: 30px;
    border-radius: 10px;
    margin: 30px 0;
    box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
}

.tea-ware-evolution h2 {
    color: #8B4513;
    font-family: 'Calligraphy';
    text-align: center;
    margin-bottom: 30px;
    font-size: 28px;
}

.evolution-container {
    display: flex;
    justify-content: space-between;
    gap: 20px;
}

.era-section {
    flex: 1;
    background: #f9f7f0;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #D2B48C;
}

.era-title {
    color: #8B4513;
    font-family: 'Calligraphy';
    font-size: 24px;
    text-align: center;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #D2B48C;
}

.tea-ware-item {
    margin-bottom: 20px;
    padding: 15px;
    background: white;
    border-radius: 6px;
    border: 1px solid #D2B48C;
}

.ware-name {
    color: #8B4513;
    font-family: 'Calligraphy';
    font-size: 18px;
    margin-bottom: 10px;
}

.ware-detail {
    color: #666;
    font-size: 14px;
    line-height: 1.6;
}

.historical-source {
    margin-top: 10px;
    padding: 8px;
    background: rgba(139, 69, 19, 0.05);
    border-radius: 4px;
    border-left: 3px solid #8B4513;
    color: #8B4513;
    font-style: italic;
    font-size: 12px;
}

.era-section {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.5s ease;
}

.era-section.visible {
    opacity: 1;
    transform: translateY(0);
}

.tea-ware-item {
    opacity: 0;
    transform: translateX(-20px);
    transition: all 0.5s ease;
}

.tea-ware-item.visible {
    opacity: 1;
    transform: translateX(0);
}

/* 添加文献查询面板样式 */
.literature-panel {
    margin-top: 40px;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
}

.literature-panel h3 {
    color: #8B4513;
    font-family: 'Calligraphy';
    text-align: center;
    margin-bottom: 20px;
    font-size: 24px;
}

.search-box {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

#literature-search {
    flex: 1;
    padding: 10px 15px;
    border: 2px solid #D2B48C;
    border-radius: 5px;
    font-size: 16px;
    color: #8B4513;
}

#search-btn {
    padding: 10px 20px;
    background: #8B4513;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-family: 'Calligraphy';
    transition: background 0.3s;
}

#search-btn:hover {
    background: #A0522D;
}

.literature-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.literature-item {
    background: #f9f7f0;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #D2B48C;
    transition: transform 0.3s, box-shadow 0.3s;
}

.literature-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(139, 69, 19, 0.2);
}

.literature-title {
    color: #8B4513;
    font-family: 'Calligraphy';
    font-size: 20px;
    margin-bottom: 10px;
    text-align: center;
}

.literature-info {
    color: #666;
    margin-bottom: 15px;
    line-height: 1.6;
}

.literature-quote {
    padding: 10px;
    background: rgba(139, 69, 19, 0.05);
    border-radius: 4px;
    border-left: 3px solid #8B4513;
}

.literature-quote p {
    color: #8B4513;
    font-style: italic;
    margin: 0;
    font-size: 14px;
}

/* 添加搜索高亮样式 */
.highlight {
    background: rgba(139, 69, 19, 0.1);
    border: 2px solid #8B4513;
}

/* 添加动画效果 */
.literature-item {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.5s ease;
}

.literature-item.visible {
    opacity: 1;
    transform: translateY(0);
}

/* 添加茶马互市样式 */
.tea-horse-trade {
    background: white;
    padding: 30px;
    border-radius: 10px;
    margin: 30px 0;
    box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
}

.tea-horse-trade h2 {
    color: #8B4513;
    font-family: 'Calligraphy';
    text-align: center;
    margin-bottom: 30px;
    font-size: 28px;
}

.trade-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
}

.trade-map {
    grid-column: 1 / -1;
    background: #f9f7f0;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #D2B48C;
}

.trade-route {
    text-align: center;
}

.route-title {
    color: #8B4513;
    font-family: 'Calligraphy';
    font-size: 24px;
    margin-bottom: 20px;
}

.route-path {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    gap: 15px;
}

.route-path .node {
    background: white;
    padding: 10px 20px;
    border-radius: 20px;
    border: 2px solid #D2B48C;
    color: #8B4513;
    font-weight: bold;
    position: relative;
    cursor: pointer;
}

.route-path .arrow {
    color: #8B4513;
    font-size: 20px;
    font-weight: bold;
}

.trade-history {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.history-item {
    background: #f9f7f0;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #D2B48C;
}

.history-item .era {
    color: #8B4513;
    font-family: 'Calligraphy';
    font-size: 20px;
    margin-bottom: 10px;
}

.history-item .content {
    color: #666;
    line-height: 1.6;
}

.history-item .source {
    margin-top: 10px;
    padding: 8px;
    background: rgba(139, 69, 19, 0.05);
    border-radius: 4px;
    border-left: 3px solid #8B4513;
    color: #8B4513;
    font-style: italic;
    font-size: 12px;
}

.cultural-exchange {
    background: #f9f7f0;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #D2B48C;
}

.cultural-exchange h3 {
    color: #8B4513;
    font-family: 'Calligraphy';
    text-align: center;
    margin-bottom: 20px;
    font-size: 22px;
}

.exchange-items {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.exchange-item {
    background: white;
    padding: 15px;
    border-radius: 6px;
    border: 1px solid #D2B48C;
}

.exchange-item .title {
    color: #8B4513;
    font-family: 'Calligraphy';
    font-size: 18px;
    margin-bottom: 10px;
    text-align: center;
}

.exchange-item .description {
    color: #666;
    font-size: 14px;
    line-height: 1.6;
}

/* 添加动画效果 */
.history-item, .exchange-item {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.5s ease;
}

.history-item.visible, .exchange-item.visible {
    opacity: 1;
    transform: translateY(0);
}

.route-path .node {
    opacity: 0;
    transform: translateX(-20px);
    transition: all 0.5s ease;
}

.route-path .node.visible {
    opacity: 1;
    transform: translateX(0);
}

/* 添加数据源样式 */
.data-source {
    color: #666;
    font-size: 14px;
    font-style: italic;
    text-align: center;
    margin-top: 5px;
}

/* 优化路线信息样式 */
.route-info {
    margin-top: 15px;
    padding: 10px;
    background: rgba(139, 69, 19, 0.05);
    border-radius: 4px;
    border-left: 3px solid #8B4513;
}

.route-info p {
    color: #666;
    font-size: 14px;
    margin: 5px 0;
    line-height: 1.4;
}

/* 添加响应式布局 */
@media (max-width: 768px) {
    .route-container {
        flex-direction: column;
    }
    
    .route-path {
        flex-wrap: wrap;
    }
    
    .node {
        margin: 5px;
    }
}

/* 朝代茶叶传播路径部分的样式 */
.dynasty-tea-routes {
    background-color: rgba(244, 241, 236, 0.9);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 30px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.section-title {
    text-align: center;
    color: #8B4513;
    margin-bottom: 20px;
    font-family: "衡山毛笔行书", "Calligraphy", serif;
    font-size: 32px;
    border-bottom: 2px solid #D2B48C;
    padding-bottom: 10px;
}

.dynasty-selector {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
}

.dynasty-btn {
    background-color: #f5f0e6;
    border: 2px solid #D2B48C;
    color: #8B4513;
    padding: 8px 20px;
    margin: 0 10px;
    font-size: 18px;
    font-family: "衡山毛笔行书", "Calligraphy", serif;
    cursor: pointer;
    border-radius: 30px;
    transition: all 0.3s ease;
}

.dynasty-btn:hover {
    background-color: #e6d9c2;
}

.dynasty-btn.active {
    background-color: #8B4513;
    color: #fff;
    border-color: #8B4513;
}

.map-container {
    border: 2px solid #D2B48C;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 20px;
    background: url("{{ url_for('static', filename='images/map_back.png') }}") no-repeat center center;
    background-size: cover;
}

.route-info-panel {
    background-color: rgba(255, 255, 255, 0.8);
    border: 1px solid #D2B48C;
    border-radius: 8px;
    padding: 15px;
}

.dynasty-info {
    display: none;
}

.dynasty-info.active {
    display: block;
}

.dynasty-info h3 {
    color: #8B4513;
    margin-bottom: 10px;
    font-family: "衡山毛笔行书", "Calligraphy", serif;
}

.dynasty-info p {
    margin: 5px 0;
    color: #5a3d2b;
    line-height: 1.6;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log("文化传播界面脚本已加载");
    
    // 初始化所有元素显示
    document.querySelectorAll('.timeline-item, .price-item, .node, .literature-item, .history-item, .exchange-item, .tea-ware-item, .era-section').forEach(item => {
        item.classList.add('visible');
        item.style.opacity = '1';
        item.style.transform = 'translateY(0)';
    });

    // 保持原有交互效果
    const nodes = document.querySelectorAll('.node');
    nodes.forEach(node => {
        node.addEventListener('click', function() {
            this.classList.toggle('active');
        });
    });

    const routes = document.querySelectorAll('.route-item');
    routes.forEach(route => {
        const routeInfo = route.querySelector('.route-info');
        if (routeInfo) {
            routeInfo.style.display = 'none';
            
            route.addEventListener('click', function() {
                routeInfo.style.display = routeInfo.style.display === 'none' ? 'block' : 'none';
            });
        }
        
        route.addEventListener('mouseenter', function() {
            this.classList.add('highlight');
        });
        route.addEventListener('mouseleave', function() {
            this.classList.remove('highlight');
        });
    });

    // 添加文献搜索功能
    const searchInput = document.getElementById('literature-search');
    const searchBtn = document.getElementById('search-btn');
    
    if (searchInput && searchBtn) {
        const literatureItems = document.querySelectorAll('.literature-item');
        
        function performSearch() {
            console.log("执行搜索");
            const searchTerm = searchInput.value.toLowerCase();
            
            literatureItems.forEach(item => {
                const keywords = item.dataset.keywords.toLowerCase();
                const title = item.querySelector('.literature-title').textContent.toLowerCase();
                const info = item.querySelector('.literature-info').textContent.toLowerCase();
                const quote = item.querySelector('.literature-quote').textContent.toLowerCase();
                
                if (searchTerm === '' || 
                    keywords.includes(searchTerm) || 
                    title.includes(searchTerm) || 
                    info.includes(searchTerm) || 
                    quote.includes(searchTerm)) {
                    item.style.display = 'block';
                    item.classList.add('highlight');
                } else {
                    item.style.display = 'none';
                    item.classList.remove('highlight');
                }
            });
        }
        
        searchBtn.addEventListener('click', performSearch);
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
    } else {
        console.error("未找到文献搜索元素");
    }

    // 添加节点悬停效果
    const routeNodes = document.querySelectorAll('.route-path .node');
    routeNodes.forEach(node => {
        node.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.1)';
            this.style.boxShadow = '0 5px 15px rgba(139, 69, 19, 0.2)';
        });
        
        node.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
            this.style.boxShadow = 'none';
        });
    });
});

// 朝代茶叶传播路径的JavaScript代码
document.addEventListener('DOMContentLoaded', function() {
    // 初始化地图
    var myChart = echarts.init(document.getElementById('tea-route-map'));
    
    // 朝代数据
    var dynastyData = {
        tang: {
            title: '唐代茶叶传播路径 (618-907)',
            routes: [
                {
                    name: '陆上丝绸之路',
                    coords: [
                        [108.94, 34.26], // 长安
                        [112.45, 34.62], // 洛阳
                        [94.66, 40.13],  // 敦煌
                        [67.00, 39.70],  // 撒马尔罕
                        [44.43, 33.31],  // 巴格达
                        [28.97, 41.01]   // 东罗马帝国(君士坦丁堡)
                    ],
                    time: '7-9世纪',
                    lineStyle: { color: '#d2691e', width: 3 }
                },
                {
                    name: '茶马古道雏形',
                    coords: [
                        [103.00, 30.01], // 四川雅安
                        [91.11, 29.97],  // 西藏拉萨
                        [85.31, 27.70],  // 尼泊尔
                        [77.21, 28.61]   // 印度
                    ],
                    time: '7-9世纪',
                    lineStyle: { color: '#8b8878', width: 2 }
                },
                {
                    name: '南海航线',
                    coords: [
                        [113.26, 23.13], // 广州
                        [102.25, 2.19],  // 马六甲
                        [72.89, 18.97]   // 印度孟买
                    ],
                    time: '唐代',
                    lineStyle: { color: '#1e90ff', width: 2 }
                },
                {
                    name: '东亚传播',
                    coords: [
                        [108.94, 34.26], // 长安
                        [135.76, 35.01]  // 日本京都(最澄、空海)
                    ],
                    time: '805年',
                    lineStyle: { color: '#9acd32', width: 2 }
                }
            ]
        },
        song: {
            title: '宋代茶叶传播路径 (960-1279)',
            routes: [
                {
                    name: '海上丝绸之路',
                    coords: [
                        [118.58, 24.91], // 泉州港
                        [102.25, 2.19],  // 马六甲
                        [79.86, 6.93],   // 斯里兰卡
                        [39.18, 21.49]   // 东非/阿拉伯
                    ],
                    time: '10-13世纪',
                    lineStyle: { color: '#4169e1', width: 3 }
                },
                {
                    name: '东海航线',
                    coords: [
                        [120.17, 30.26], // 浙江杭州
                        [118.08, 24.48], // 福建
                        [126.98, 37.57], // 朝鲜半岛
                        [135.76, 35.01]  // 日本京都(荣西禅师)
                    ],
                    time: '12世纪',
                    lineStyle: { color: '#1e90ff', width: 2 }
                },
                {
                    name: '茶马古道',
                    coords: [
                        [100.97, 22.78], // 云南普洱
                        [91.11, 29.97],  // 西藏拉萨
                        [77.21, 28.61],  // 印度
                        [103.00, 30.01], // 四川雅安
                        [101.96, 30.05]  // 康定
                    ],
                    time: '宋代',
                    lineStyle: { color: '#8b4513', width: 3 }
                },
                {
                    name: '北方草原茶路',
                    coords: [
                        [114.48, 38.03], // 河北
                        [112.56, 37.87], // 山西
                        [106.91, 47.92], // 蒙古高原
                        [82.93, 55.01]   // 西伯利亚
                    ],
                    time: '12-13世纪',
                    lineStyle: { color: '#556b2f', width: 2 }
                }
            ]
        },
        yuan: {
            title: '元代茶叶传播路径 (1271-1368)',
            routes: [
                {
                    name: '草原茶路扩展',
                    coords: [
                        [116.40, 39.91], // 元大都(北京)
                        [106.91, 47.92], // 蒙古
                        [82.93, 55.01],  // 西伯利亚
                        [37.62, 55.75]   // 莫斯科
                    ],
                    time: '13-14世纪',
                    lineStyle: { color: '#8a2be2', width: 3 }
                },
                {
                    name: '海上贸易延续',
                    coords: [
                        [118.08, 24.48], // 福建
                        [118.58, 24.91], // 泉州港
                        [102.25, 2.19],  // 东南亚
                        [50.56, 26.02]   // 波斯湾
                    ],
                    time: '13-14世纪',
                    lineStyle: { color: '#1e90ff', width: 3 }
                },
                {
                    name: '藏传佛教路线',
                    coords: [
                        [116.40, 39.91], // 元大都(北京)
                        [91.11, 29.97],  // 西藏拉萨
                        [67.00, 39.70]   // 中亚(撒马尔罕)
                    ],
                    time: '元代',
                    lineStyle: { color: '#9932cc', width: 2 }
                }
            ]
        },
        ming: {
            title: '明代茶叶传播路径 (1368-1644)',
            routes: [
                {
                    name: '郑和下西洋',
                    coords: [
                        [118.08, 24.48], // 福建
                        [120.17, 30.26], // 浙江
                        [102.25, 2.19],  // 马六甲
                        [77.21, 28.61],  // 印度
                        [39.18, 21.49],  // 阿拉伯
                        [39.25, -6.82]   // 东非
                    ],
                    time: '1405-1433年',
                    lineStyle: { color: '#1e90ff', width: 4 }
                },
                {
                    name: '万里茶道',
                    coords: [
                        [118.08, 24.48], // 福建武夷山
                        [115.89, 28.68], // 江西
                        [114.31, 30.59], // 湖北
                        [113.66, 34.76], // 河南
                        [112.56, 37.87], // 山西
                        [115.32, 40.97], // 张家口
                        [106.57, 50.42]  // 恰克图(中俄边境)
                    ],
                    time: '明代',
                    lineStyle: { color: '#8b4513', width: 3 }
                },
                {
                    name: '欧洲殖民航线',
                    coords: [
                        [118.08, 24.48], // 福建
                        [113.26, 23.13], // 广东
                        [113.54, 22.20], // 澳门(1557年)
                        [-9.14, 38.71]   // 葡萄牙里斯本
                    ],
                    time: '16-17世纪',
                    lineStyle: { color: '#ff8c00', width: 2 }
                },
                {
                    name: '荷兰茶叶航线',
                    coords: [
                        [118.08, 24.48], // 福建
                        [113.26, 23.13], // 广东
                        [4.90, 52.37]    // 阿姆斯特丹(1610年)
                    ],
                    time: '1610年起',
                    lineStyle: { color: '#ff4500', width: 2 }
                }
            ]
        },
        qing: {
            title: '清代茶叶传播路径 (1644-1911)',
            routes: [
                {
                    name: '万里茶道鼎盛',
                    coords: [
                        [118.08, 24.48], // 福建
                        [112.98, 28.20], // 湖南
                        [114.31, 30.59], // 汉口
                        [115.32, 40.97], // 张家口
                        [106.57, 50.42], // 恰克图
                        [37.62, 55.75],  // 莫斯科
                        [30.33, 59.94]   // 圣彼得堡
                    ],
                    time: '17-19世纪',
                    lineStyle: { color: '#dc143c', width: 4 }
                },
                {
                    name: '英国东印度公司航线',
                    coords: [
                        [113.26, 23.13], // 广州
                        [77.21, 28.61],  // 印度
                        [18.42, -34.08], // 好望角
                        [-0.13, 51.51]   // 伦敦
                    ],
                    time: '18-19世纪',
                    lineStyle: { color: '#191970', width: 3 }
                },
                {
                    name: '北美航线',
                    coords: [
                        [113.26, 23.13], // 广州
                        [-74.01, 40.71]  // 纽约
                    ],
                    time: '1784年起',
                    lineStyle: { color: '#32cd32', width: 3 }
                },
                {
                    name: '茶种殖民扩散',
                    coords: [
                        [118.08, 24.48], // 福建
                        [91.79, 26.14],  // 印度阿萨姆
                        [80.77, 7.87],   // 锡兰(斯里兰卡)
                        [41.71, 44.78]   // 格鲁吉亚(1893年)
                    ],
                    time: '19世纪',
                    lineStyle: { color: '#ff8c00', width: 2.5 }
                }
            ]
        }
    };
    
    // 城市坐标点
    var cities = [
        {name: '长安', value: [108.94, 34.26]},
        {name: '洛阳', value: [112.45, 34.62]},
        {name: '杭州', value: [120.17, 30.26]},
        {name: '泉州', value: [118.58, 24.91]},
        {name: '广州', value: [113.26, 23.13]},
        {name: '敦煌', value: [94.66, 40.13]},
        {name: '撒马尔罕', value: [67.00, 39.70]},
        {name: '巴格达', value: [44.43, 33.31]},
        {name: '马六甲', value: [102.25, 2.19]},
        {name: '威尼斯', value: [12.33, 45.44]},
        {name: '昆明', value: [103.83, 25.40]},
        {name: '拉萨', value: [91.11, 29.97]},
        {name: '大都', value: [116.40, 39.91]},
        {name: '乌鲁木齐', value: [87.62, 43.82]},
        {name: '莫斯科', value: [37.62, 55.75]},
        {name: '麦加', value: [39.18, 21.49]},
        {name: '东京', value: [139.69, 35.69]},
        {name: '首尔', value: [126.98, 37.57]},
        {name: '阿姆斯特丹', value: [4.90, 52.37]},
        {name: '伦敦', value: [-0.13, 51.51]},
        {name: '巴黎', value: [2.35, 48.86]},
        {name: '纽约', value: [-74.01, 40.71]},
        {name: '波士顿', value: [-71.06, 42.36]}
    ];
    
    // 当前选择的朝代
    var currentDynasty = 'tang';
    
    // 更新地图
    function updateMap(dynasty) {
        var data = dynastyData[dynasty];
        
        var series = [{
            type: 'scatter',
            coordinateSystem: 'geo',
            data: cities.map(function(item) {
                return {
                    name: item.name,
                    value: item.value,
                    symbolSize: 10,
                    itemStyle: {
                        color: '#8B4513',
                        borderColor: '#fff',
                        borderWidth: 2
                    }
                };
            }),
            label: {
                show: true,
                formatter: '{b}',
                position: 'right',
                fontSize: 12,
                fontWeight: 'bold',
                color: '#5a3d2b',
                backgroundColor: 'rgba(255, 255, 255, 0.7)',
                padding: [3, 5],
                borderRadius: 3
            }
        }];
        
        // 添加路线
        data.routes.forEach(function(route, index) {
            // 将路线加入series
            series.push({
                name: route.name,
                type: 'lines',
                coordinateSystem: 'geo',
                effect: {
                    show: true,
                    period: 6,
                    trailLength: 0.7,
                    color: '#fff',
                    symbolSize: 5
                },
                lineStyle: route.lineStyle || {
                    color: '#8B4513',
                    width: 2,
                    curveness: 0.2
                },
                data: [{
                    coords: route.coords,
                    name: route.name
                }]
            });
            
            // 添加路线动效
            series.push({
                name: route.name + ' 动效',
                type: 'lines',
                coordinateSystem: 'geo',
                zlevel: 2,
                effect: {
                    show: true,
                    period: 6,
                    trailLength: 0.5,
                    symbol: 'arrow',
                    symbolSize: 8
                },
                lineStyle: {
                    color: route.lineStyle.color,
                    width: 1,
                    opacity: 0.6,
                    curveness: 0.2
                },
                data: [{
                    coords: route.coords,
                    name: route.name
                }]
            });
            
            // 添加时间标注
            var midIndex = Math.floor(route.coords.length / 2) - 1;
            if (midIndex < 0) midIndex = 0;
            
            var midCoord = route.coords[midIndex];
            var nextCoord = route.coords[midIndex + 1];
            var labelPos = [
                (midCoord[0] + nextCoord[0]) / 2,
                (midCoord[1] + nextCoord[1]) / 2
            ];
            
            series.push({
                type: 'scatter',
                coordinateSystem: 'geo',
                data: [{
                    name: route.time,
                    value: [labelPos[0], labelPos[1]],
                    symbolSize: 0
                }],
                label: {
                    show: true,
                    formatter: route.time,
                    position: 'middle',
                    backgroundColor: 'rgba(255, 255, 255, 0.8)',
                    padding: [5, 10],
                    borderRadius: 4,
                    fontSize: 14,
                    color: '#8B4513',
                    fontWeight: 'bold',
                    borderColor: '#D2B48C',
                    borderWidth: 1
                }
            });
        });
        
        var option = {
            title: {
                text: data.title,
                textStyle: {
                    color: '#8B4513',
                    fontSize: 18
                },
                left: 'center',
                top: 10
            },
            tooltip: {
                trigger: 'item',
                formatter: function(params) {
                    if (params.seriesType === 'lines') {
                        return params.name + '<br>时间: ' + 
                               dynastyData[currentDynasty].routes.find(r => r.name === params.name).time;
                    } else {
                        return params.name;
                    }
                }
            },
            geo: {
                map: 'world',
                roam: true,
                center: [90, 30],
                zoom: 2,
                label: {
                    show: false
                },
                emphasis: {
                    label: {
                        show: false
                    },
                    itemStyle: {
                        areaColor: 'rgba(245, 245, 245, 0.5)'
                    }
                },
                itemStyle: {
                    areaColor: 'rgba(245, 222, 179, 0.3)',
                    borderColor: 'rgba(210, 180, 140, 0.5)'
                },
                backgroundColor: 'transparent'
            },
            series: series
        };
        
        myChart.setOption(option, true);
    }
    
    // 切换朝代按钮事件
    document.querySelectorAll('.dynasty-btn').forEach(function(btn) {
        btn.addEventListener('click', function() {
            var dynasty = this.getAttribute('data-dynasty');
            
            // 切换按钮样式
            document.querySelectorAll('.dynasty-btn').forEach(function(b) {
                b.classList.remove('active');
            });
            this.classList.add('active');
            
            // 切换信息面板
            document.querySelectorAll('.dynasty-info').forEach(function(info) {
                info.classList.remove('active');
            });
            document.querySelector('.' + dynasty + '-info').classList.add('active');
            
            // 更新当前朝代
            currentDynasty = dynasty;
            
            // 更新地图
            updateMap(dynasty);
        });
    });
    
    // 初始化显示唐代
    updateMap('tang');
    
    // 响应窗口大小变化
    window.addEventListener('resize', function() {
        myChart.resize();
    });
});
</script>
{% endblock %}